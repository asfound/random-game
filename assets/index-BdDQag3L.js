(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function G(e){let t=JSON.parse(localStorage.getItem("asfound_game_localScores"))||[];(t.length<10||e>t[t.length-1])&&(t.push(e),t.sort((n,o)=>o-n),t.length>10&&t.pop(),localStorage.setItem("asfound_game_localScores",JSON.stringify(t)))}function V(){const e=localStorage.getItem("asfound_game_localScores"),t=e?JSON.parse(e):[],n=document.querySelector(".score");n.innerHTML="";const o=document.createElement("ol");o.classList.add(".score__list"),n.appendChild(o),t.forEach((s,a)=>{const c=document.createElement("li");c.classList.add("score__item"),c.innerHTML=`
      <span class="score__rank">${a+1}.</span>
      <span class="score__value">${s}</span>
    `,o.appendChild(c)})}const D="6702c398acd3cb34a8923d9d",N="$2a$10$lxCiUALMchhbANQOgqQzqOAM0viir8h9pKA7OCtL9XLvmZAa0HBp.",O=`https://api.jsonbin.io/v3/b/${D}`;async function R(){try{return(await(await fetch(O,{headers:{"X-Access-Key":N,"Content-Type":"application/json","X-Bin-Meta":!1}})).json()).top}catch(e){console.error("Ошибка при получении данных:",e)}}async function z(e){try{const t=await R();(t.length<10||e.score>t[t.length-1].score)&&(t.push(e),t.sort((o,s)=>s.score-o.score),t.length>10&&t.pop()),(await fetch(O,{method:"PUT",headers:{"X-Access-Key":N,"Content-Type":"application/json"},body:JSON.stringify({top:t})})).ok||console.error("Ошибка при обновлении данных")}catch(t){console.error("Ошибка при сохранении данных:",t)}}async function Q(){const e=document.querySelector(".leaderboard");e.innerHTML="";const t=document.querySelector(".loader");t.classList.remove("hidden");try{const n=await R(),o=document.createElement("ol");o.classList.add("leaderboard__list"),e.appendChild(o),n&&n.length>0&&n.forEach((s,a)=>{const c=document.createElement("li");c.classList.add("leaderboard__item"),c.innerHTML=`
        <span class="leaderboard__rank">${a+1}.</span>
        <span class="leaderboard__name">${s.name}</span>
        <span class="leaderboard__score">${s.score}</span>
      `,o.appendChild(c)})}catch(n){console.error("Ошибка при получении данных:",n)}finally{t.classList.add("hidden")}}const Y=""+new URL("audio/viewer.mp3",import.meta.url).href,Z=""+new URL("audio/reviewer.mp3",import.meta.url).href,W=""+new URL("audio/silence.mp3",import.meta.url).href,ee=""+new URL("audio/notification.mp3",import.meta.url).href;let f=!1;const w={hitViewer:new Audio(Y),hitReviewer:new Audio(Z),backgroundSound:new Audio(W),notification:new Audio(ee)};function v(e){if(!f){const t=w[e];t&&t.play()}}function B(){if(!f){const e=w.backgroundSound;e.loop=!0,e.volume=.1,e.play()}}function q(){const e=w.backgroundSound;e&&(e.pause(),e.currentTime=0)}const M=document.querySelector(".mute__icon"),te=document.querySelector(".sound__button");te.addEventListener("click",()=>{f=!f,ne(),!f&&l?B():q()});function ne(){f?M.src="./assets/icons/mute.png":M.src="./assets/icons/audio.png"}let l=!1,g=!0,d,_,U,p,P,T,u=!1,r=null;function se(){g&&(document.querySelector(".main__button").innerText="Сбросить",x(),g=!1,d=0,_=3,p=60,U=setInterval(oe,500),le())}function oe(){if(u)S(),u=!1;else{if(g)return;r&&C(),ae(),S(),u=!0}}function ae(){let e=ce(),t=document.createElement("img");t.classList.add("mole"),t.draggable=!1,t.src=`./assets/images/mole_${e}.svg`,e==="1"&&t.classList.add("viewer"),t.addEventListener("click",k,{once:!0}),t.addEventListener("touchstart",k,{once:!0});let n=re();r=document.getElementById(n),r.appendChild(t)}function re(){return Math.floor(Math.random()*9).toString()}function ce(){return Math.floor(Math.random()*2).toString()}function k(e){e.preventDefault(),e.target.classList.add("hit"),e.target.classList.contains("viewer")?(v("hitViewer"),_-=1,_===0&&(d=0,E()),ie()):(v("hitReviewer"),d+=10,d===100&&E(),document.querySelector(".stats__score").innerHTML=`${d}/100`)}function ie(){const e="#";document.querySelector(".lives__current").innerHTML=`${e.repeat(_)}`,document.querySelector(".lives__lost").innerHTML=`${e.repeat(3-_)}`}function b(){if(u&&(S(),u=!1),F(),g=!0,r!=null&&r.querySelector(".tile__cap")){const e=r.querySelector(".tile__cap");e&&e.addEventListener("transitionend",()=>{C(),r=null,x()},{once:!0})}document.querySelector(".main__button").innerHTML="Начать"}function E(){u&&(S(),u=!1),F(),g=!0;const e=ue(d,p,l);G(e);const t=me(e);z(t),r.querySelector(".tile__cap").addEventListener("transitionend",()=>{C(),r=null,de(e),x()},{once:!0}),document.querySelector(".main__button").innerHTML="Начать"}function S(){if(r){const e=r.querySelector(".tile__cap");e&&e.classList.toggle("lifted")}else return}function le(){P=setInterval(()=>{p--,document.querySelector(".stats__time").textContent=`${p}`,p==0&&E()},1e3)}function F(){clearInterval(P),clearInterval(U)}function de(e){const t=document.querySelector(".dialog"),n=document.querySelector(".dialog__message");_===0&&(n.textContent=`Тебя отчислили!
Твой счет: ${e}.
Попробуй еще раз.`),p<=0&&(n.textContent=`Ты не успел вернуть все баллы!
Твой счет: ${e}.
Попробуй еще раз.`),d===100&&(n.textContent=`Ура, ты вернул свои баллы!
Твой итоговый счет: ${e}.
`),v("notification"),t.showModal()}document.querySelector(".dialog__button").addEventListener("click",()=>{const e=document.querySelector(".dialog"),t=document.querySelector(".dialog__message");e.close(),t.textContent=""});function x(){document.querySelector(".stats__time").innerHTML="60",document.querySelector(".stats__score").innerHTML="0/100",document.querySelector(".lives__lost").innerHTML="",document.querySelector(".lives__current").innerHTML="###"}function C(){if(r)T=r.querySelector(".mole"),T.remove();else return}function ue(e,t,n){return t>0&&e>0&&(e+=t),n&&(e*=2),e}function me(e){return{name:localStorage.getItem("asfound_game_playerName"),score:e}}const i=document.querySelector(".flashlight"),J=document.querySelector(".flashlight__container"),fe=document.querySelector(".flash__button");fe.addEventListener("click",pe);function pe(){l?q():B(),b(),J.classList.toggle("hidden"),l=!l}document.addEventListener("keydown",function(e){(e.key==="Escape"||e.code==="Escape")&&l&&(J.classList.add("hidden"),b(),q(),l=!l)});document.addEventListener("mousemove",e=>{const t=e.clientX,n=e.clientY;i.style.left=`${t}px`,i.style.top=`${n}px`});function ge(){i.style.boxShadow="0 0 0 9999px #000",i.style.width="350px",i.style.height="350px",i.style.transform="translate(-50%, -50%)",i.style.position="absolute",i.style.zIndex="100",i.style.background="radial-gradient(circle, rgba(0, 0, 0, 0.11) 10%, rgba(0, 0, 0, 0) 48%, rgba(0, 0, 0, 0.72) 60%, rgba(0, 0, 0, 1) 70%)"}setInterval(ge,100);const m=document.querySelector(".input"),L=document.querySelector(".check");m.addEventListener("input",()=>{m.value.trim()!==""?L.classList.remove("hidden"):L.classList.add("hidden")});function K(){const e=m.value.trim().slice(0,11);e!==""&&(localStorage.setItem("asfound_game_playerName",e),L.classList.add("hidden"),m.blur())}m.addEventListener("keydown",e=>{e.key==="Enter"&&K()});L.addEventListener("click",K);document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("asfound_game_playerName");e&&(m.value=e,L.classList.add("hidden"))});function _e(){return!!localStorage.getItem("asfound_game_playerName")}function X(){const e=document.querySelector(".game");e.innerHTML="",e.append(Le(),ye(),ve())}function Le(){const e=document.createElement("div");e.classList.add("stats");const t=document.createElement("div");t.classList.add("stats__time"),t.textContent="60";const n=document.createElement("div");n.classList.add("stats__score"),n.textContent="0/100";const o=document.createElement("div");o.classList.add("stats__lives");const s=document.createElement("span");s.classList.add("lives__lost");const a=document.createElement("span");return a.classList.add("lives__current"),a.textContent="###",o.append(s,a),e.append(t,n,o),e}function ye(){const e=document.createElement("div");e.classList.add("board");for(let t=0;t<9;t++)e.appendChild(he(t));return e}function he(e){let t=document.createElement("div");t.classList.add("board__tile"),t.id=e.toString();let n=document.createElement("img");return n.classList.add("tile__cap"),n.draggable=!1,n.src=`./assets/images/${e}.png`,t.appendChild(n),t}function ve(){const e=document.createElement("button");return e.classList.add("main__button","button"),e.textContent="Начать",e.addEventListener("click",I),e.addEventListener("touchstart",I),e}function I(e){e.preventDefault(),_e()?g?se():b():Se()}function Se(){const e=document.querySelector(".dialog"),t=document.querySelector(".dialog__message");e.addEventListener("close",()=>{m.focus()},{once:!0}),t.textContent="Введите имя и нажмите Enter, чтобы продолжить!",e.showModal(),v("notification")}const y={text1:"В этой игре у тебе нужно отыграться на Reviewer1, который однажды необоснованно завалил тебя на кросс-чеке.",text2:'Попади по Reviewer1, чтобы получить <span class="rules__score">10 баллов</span>. Будь осторожен, не обижай ни в чём не виновного наблюдателя, иначе получишь предупреждение - <span class="rules__life">#</span>.',text3:'Твоя задача набрать <span class="rules__score">100 баллов</span> за <span class="rules__time">60 секунд</span>. Игра закончится, если тебе вынесли три предупреждения или закончилось время.',text4:"Выиграй в режиме фонарика (доступно только на компьютерах), чтобы удвоить очки в конце игры."};function be(){const e=document.querySelector(".rules");e.innerHTML="";const t=document.createElement("p");t.classList.add("rules__text"),t.textContent=y.text1;const n=document.createElement("p");n.classList.add("rules__text"),n.innerHTML=y.text2;const o=document.createElement("p");o.classList.add("rules__text"),o.innerHTML=y.text3;const s=document.createElement("p");s.classList.add("rules__text"),s.innerHTML=y.text4;const a=document.createElement("div");a.classList.add("rules__container");const c=$("./assets/images/mole_0.svg","reviewer","Reviewer1"),j=$("./assets/images/mole_1.svg","viewer","Viewer");a.append(c,j),e.append(t,n,o,s,a)}function $(e,t,n){const o=document.createElement("figure");o.classList.add("rules__figure");const s=document.createElement("img");s.src=e,s.alt=t,s.classList.add("rules__img");const a=document.createElement("figcaption");return a.classList.add("rules__caption"),a.textContent=n,o.append(s,a),o}const H=document.querySelectorAll(".menu__item"),h=document.querySelectorAll(".tab"),A={rules:be,score:V,leaderboard:Q,game:X};H.forEach((e,t)=>{e.addEventListener("click",()=>{h[t].classList.contains("score")||b(),H.forEach(o=>o.classList.remove("menu__active")),h.forEach(o=>o.classList.add("hidden")),e.classList.add(".menu__active"),h[t].classList.remove("hidden"),Array.from(h[t].classList).forEach(o=>{A[o]&&A[o]()})})});window.onload=function(){X()};
//# sourceMappingURL=index-BdDQag3L.js.map
